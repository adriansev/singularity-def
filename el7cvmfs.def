Bootstrap: yum
OSVersion: 7
MirrorURL: http://monitor.spacescience.ro/mirrors/centos/7/os/x86_64/
UpdateURL: http://monitor.spacescience.ro/mirrors/centos/7/updates/x86_64/
Include: yum curl yum-utils fuse fuse-libs fuse3 fuse3-libs bash util-linux sudo bindfs

%files
default.local_pac /etc/cvmfs/default.local
sudoers_cvmfs /etc/sudoers

%environment

%post
# replace centos base links
#yum-config-manager --save --setopt=base.mirrorlist= &>/dev/null
yum-config-manager --save --setopt=base.baseurl=http://monitor.spacescience.ro/mirrors/centos/7/os/x86_64/ &>/dev/null
yum-config-manager --save --setopt=base.keepcache=False &>/dev/null

#yum-config-manager --save --setopt=updates.mirrorlist= &>/dev/null
yum-config-manager --save --setopt=updates.baseurl=http://monitor.spacescience.ro/mirrors/centos/7/updates/x86_64/ &>/dev/null
yum-config-manager --save --setopt=updates.keepcache=False &>/dev/null

#yum-config-manager --save --setopt=extras.mirrorlist= &>/dev/null
yum-config-manager --save --setopt=extras.baseurl=http://monitor.spacescience.ro/mirrors/centos/7/extras/x86_64/ &>/dev/null
yum-config-manager --save --setopt=extras.keepcache=False &>/dev/null

#yum-config-manager --save --setopt=centosplus.mirrorlist= &>/dev/null
yum-config-manager --save --setopt=centosplus.baseurl=http://monitor.spacescience.ro/mirrors/centos/7/centosplus/x86_64/ &>/dev/null
yum-config-manager --save --setopt=centosplus.keepcache=False &>/dev/null

#yum-config-manager --save --setopt=epel.mirrorlist= &>/dev/null
yum-config-manager --save --setopt=epel.baseurl=http://monitor.spacescience.ro/mirrors/epel/7/x86_64/ &>/dev/null
yum-config-manager --save --setopt=epel.keepcache=False &>/dev/null

#yum-config-manager --save --setopt=epel-debuginfo.mirrorlist= &>/dev/null
yum-config-manager --save --setopt=epel-debuginfo.baseurl=http://monitor.spacescience.ro/mirrors/epel/7/x86_64/debug/ &>/dev/null
yum-config-manager --save --setopt=epel-debuginfo.keepcache=False &>/dev/null

#yum-config-manager --save --setopt=epel-source.mirrorlist= &>/dev/null
yum-config-manager --save --setopt=epel-source.baseurl=http://monitor.spacescience.ro/mirrors/epel/7/SRPMS/ &>/dev/null
yum-config-manager --save --setopt=epel-source.keepcache=False &>/dev/null

yum -y update && yum -y install https://ecsft.cern.ch/dist/cvmfs/cvmfs-release/cvmfs-release-latest.noarch.rpm https://dl.fedoraproject.org/pub/epel/epel-release-latest-7.noarch.rpm;
yum install -y cvmfs cvmfs-config-default cvmfs-fuse3;
rm -rf /var/cache/yum;

%runscript

bash

